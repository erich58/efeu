#	Speicher Testen

if
	test $# -ne 1
then
	echo "Aufruf: $0 memlog"
	exit 1
fi

sort -n $1 | awk '
BEGIN {
	last = 0
	alloc = 0
	num = 0
}

last != $1 {
	if	(alloc)
		printf("%s\t%s\t@alloc\t%d\n", last, num, alloc);

	last = $1 + 0;
	alloc = 0;
}

$3 == "alloc" {
	alloc = $4 + 0;
	num = $2;
}

$3 == "free" {
	if	(alloc != $4)
	{
		printf("%s\t%s\t@alloc\t%d\n", last, num, alloc);
		printf("%s\t%s\t@free\t%d\n", last, $2, $4);
	}

	alloc = 0;
}

{ print }

END {
	if	(alloc)
		printf("%s\t%s\t@alloc\t%d\n", last, num, alloc);
}
'
